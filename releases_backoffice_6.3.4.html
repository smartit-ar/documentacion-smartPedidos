<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notas de Release: Backoffice 6.3.4 - Visualización de Intervalos</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" />

    <style>
        /* Importación de Fuentes de Google Fonts */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Fira+Code:wght@400&display=swap');

        /* Variables CSS para la Paleta de Colores */
        :root {
            --bg-color: #f4f7f9;
            --card-bg-color: #ffffff;
            --text-color: #212529;
            --text-muted-color: #6c757d;
            --border-color: #dee2e6;
            --primary-color: #0056b3;
            --analysis-bg: #e6f7ff;
            --analysis-border: #91d5ff;
            --deployment-bg: #f0fdf4;
            --deployment-border: #86efac;
        }

        /* Estilos Base */
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 2em;
            line-height: 1.7;
        }

        .container {
            max-width: 960px;
            margin: 0 auto;
        }

        /* Encabezado Principal */
        .main-header {
            background-color: var(--card-bg-color);
            padding: 2em;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            margin-bottom: 2.5em;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        .main-header h1 {
            margin: 0 0 0.25em 0;
            font-size: 2.2em;
            color: var(--primary-color);
        }

        .main-header p {
            margin: 0;
            font-size: 1.1em;
            color: var(--text-muted-color);
        }

        /* Información de Despliegue */
        .deployment-info-box {
            background-color: var(--deployment-bg);
            border-left: 4px solid var(--deployment-border);
            padding: 1em 1.5em;
            margin-bottom: 2.5em;
            border-radius: 4px;
        }

        .deployment-info-box h4 {
            margin-top: 0;
            font-size: 1.2em;
            color: #166534;
        }

        .deployment-info-box p {
            margin: 0.5em 0 0 0;
            font-family: 'Fira Code', monospace;
            font-size: 0.95em;
        }

        /* Secciones de Servicio */
        .service-section {
            margin-bottom: 3em;
        }

        .service-section>h2 {
            font-size: 1.8em;
            color: var(--primary-color);
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 0.5em;
            margin-bottom: 1.5em;
        }

        /* Tarjeta de Componente (details) */
        .component-card {
            background-color: var(--card-bg-color);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            margin-bottom: 2em;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            overflow: hidden;
        }

        /* Encabezado de la Tarjeta (summary) */
        .component-header {
            padding: 1em 1.5em;
            background-color: #fafafa;
            border-bottom: 1px solid var(--border-color);
            cursor: pointer;
            list-style: none; /* Oculta el marcador de triángulo por defecto */
        }

        /* Oculta el marcador de triángulo en WebKit (Chrome/Safari) */
        .component-header::-webkit-details-marker {
            display: none;
        }

        .component-header h3 {
            margin: 0;
            font-family: 'Fira Code', monospace;
            font-size: 1.2em;
        }

        /* Cuerpo de la Tarjeta */
        .component-body {
            padding: 1.5em;
        }

        .component-body h4 {
            margin-top: 1.5em;
            margin-bottom: 0.5em;
            font-size: 1.2em;
            color: #343a40;
        }

        .component-body h5 {
            margin-top: 1.5em;
            margin-bottom: 0.5em;
            font-size: 1.1em;
            font-weight: 700;
        }

        /* Caja de Conclusión del Análisis */
        .analysis-box {
            background-color: var(--analysis-bg);
            border-left: 4px solid var(--analysis-border);
            padding: 1em 1.5em;
            margin-top: 1.5em;
            border-radius: 4px;
        }

        .analysis-box h4 {
            margin-top: 0;
            font-size: 1.1em;
            color: var(--primary-color);
        }

        /* --- CSS PARA BLOQUES DE CÓDIGO --- */
        .component-body pre {
            padding: 1.2em !important;
            margin: 1em 0 !important;
            border-radius: 6px;
            font-family: 'Fira Code', monospace !important;
            font-size: 0.9em !important;
            line-height: 1.5 !important;
            border: 1px solid var(--border-color);
            background-color: #2d2d2d; 
            color: #ccc;
            white-space: pre-wrap !important;
            overflow-wrap: break-word !important;
        }

        .component-body pre code {
            font-family: 'Fira Code', monospace !important;
            white-space: pre-wrap !important;
        }
    </style>
</head>

<body>

    <div class="container">
        <header class="main-header">
            <h1>Notas de Release: Backoffice 6.3.4</h1>
            <p>
                Mejoras en visualización de intervalos en Monitoreo de Latencias.
            </p>
        </header>

        <div class="deployment-info-box">
            <h4>Información de Despliegue</h4>
            <p><b>Versión:</b> 6.3.4</p>
            <p><b>Fecha de Despliegue:</b> 29/01/2026</p>
            <p><b>AWS Task:</b> [Pendiente]</p>
            <p><b>Commits:</b> debc1eba9dec5c5ebff1883b3d8362e1b7467b14</p>
        </div>

        <section id="summary" class="service-section">
            <h2>Resumen General de la Versión</h2>
            <p>
                Esta actualización introduce lógica dinámica para el manejo de intervalos de tiempo en el dashboard de latencias. Se soluciona la limitación que asumía siempre una visualización horaria, permitiendo ahora filtrar, ordenar y visualizar correctamente los datos agrupados por día. Esto facilita a los operadores alternar entre vistas de detalle intradía y tendencias macro de varios días.
            </p>
        </section>

        <section id="technical-analysis" class="service-section">
            <h2>Análisis Técnico Detallado</h2>

            <!-- Bloque para latencias.component.ts -->
            <details class="component-card" open>
              <summary class="component-header">
                <h3>app/src/app/pages/monitoring/latencias/latencias.component.ts</h3>
              </summary>
              <div class="component-body">
                  <h4>Análisis General</h4>
                  <p>
                    Se implementa una lógica condicional para determinar qué "buckets" (intervalos) mostrar en el gráfico. Se añade procesamiento específico para el filtrado y ordenamiento de claves cuando el intervalo seleccionado es "Día".
                  </p>
                  
                  <h4>Cambios Detallados</h4>
            
                  <h5>Dinamización de la Visualización por Intervalo (Día/Hora)</h5>
                  <p><b>Explicación:</b> Se separa la lógica de generación de claves del gráfico. Ahora se evalúa <code>this.comboIntervalo</code> para decidir si aplicar la lógica de recorte horario o la nueva lógica de filtrado diario.</p>
                  
                  <h5>Filtrado y Ordenamiento de Datos Diarios</h5>
                  <p><b>Explicación:</b> Para el intervalo "Día", se convierten las claves a números, se filtran según el rango <code>dayFrom</code> - <code>dayTo</code> seleccionado por el usuario, se ordenan ascendentemente y se formatean de nuevo a string. Esto garantiza que el eje X del gráfico sea cronológico y relevante.</p>

                  <b>Código Antes:</b>
                  <pre><code class="language-typescript">
      console.log('buckets')
      console.log(buckets)

      const lastHourIndex = Object.keys(buckets)
        .map((k, i) => buckets[k].count > 0 ? i : -1)
        .reduce((a, b) => Math.max(a, b), -1);

      const bucketKeys = Object.keys(buckets).slice(0, lastHourIndex + 1);
                  </code></pre>
                  
                  <b>Código Después:</b>
                  <pre><code class="language-typescript">
      console.log('buckets')
      console.log(buckets)

      let bucketKeys: string[] = [];

      if (!this.comboIntervalo || this.comboIntervalo === 'Hora') {
        const lastHourIndex = Object.keys(buckets)
          .map((k, i) => buckets[k].count > 0 ? i : -1)
          .reduce((a, b) => Math.max(a, b), -1);

        bucketKeys = Object.keys(buckets).slice(0, lastHourIndex + 1);
      }

      if (this.comboIntervalo === 'Dia') {
        bucketKeys = Object.keys(buckets)
          .map(k => Number(k))
          .filter(d => d >= dayFrom && d <= dayTo)
          .sort((a, b) => a - b)
          .map(d => d.toString().padStart(2, '0'));

      }
                  </code></pre>
                  
                  <div class="analysis-box">
                  <h4>Conclusión del análisis</h4>
                  <p><b>Observabilidad:</b> Permite transicionar fluidamente entre una vista "minuto a minuto" y una vista macro mensual.<br>
                  <b>Coherencia:</b> Asegura que los datos mostrados correspondan estrictamente al rango de días seleccionado, eliminando ruido visual.</p>
                </div>
              </div>
            </details>

        </section>
    </div>

    <!-- Scripts de Prism.js para resaltar código -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>

</body>
</html>
